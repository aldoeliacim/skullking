<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="app.title">Skull King</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè¥‚Äç‚ò†Ô∏è</text></svg>">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pirata+One&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Language Switcher -->
        <button id="lang-toggle" class="lang-btn" title="Switch language">
            <span id="lang-flag">EN</span>
        </button>

        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="login-container">
                <div class="logo">
                    <div class="skull-icon">&#9760;</div>
                    <h1>Skull King</h1>
                    <p class="tagline" data-i18n="app.subtitle">A trick-taking pirate card game</p>
                </div>
                <div class="login-form">
                    <div class="input-group">
                        <label for="username-input" data-i18n="login.yourName">Your Name</label>
                        <input type="text" id="username-input" data-i18n-placeholder="login.enterName" placeholder="Captain..." maxlength="20" autocomplete="off">
                    </div>
                    <button id="create-game-btn" class="btn btn-primary btn-large">
                        <span class="btn-icon">+</span>
                        <span data-i18n="login.createGame">Create Game</span>
                    </button>
                    <div class="divider"><span data-i18n="login.or">or join existing</span></div>
                    <div class="input-group">
                        <label for="game-id-input" data-i18n="login.gameCode">Game Code</label>
                        <input type="text" id="game-id-input" data-i18n-placeholder="login.enterGameId" placeholder="Enter code..." autocomplete="off">
                    </div>
                    <button id="join-game-btn" class="btn btn-secondary">
                        <span data-i18n="login.joinGame">Join Game</span>
                    </button>
                </div>
                <div id="login-error" class="error-message"></div>
            </div>
        </div>

        <!-- Lobby Screen -->
        <div id="lobby-screen" class="screen">
            <div class="lobby-container">
                <div class="lobby-header">
                    <h2 data-i18n="lobby.title">Game Lobby</h2>
                    <div class="game-code-box">
                        <span class="label" data-i18n="lobby.shareCode">Share this code:</span>
                        <div class="code-display">
                            <span id="lobby-game-id" class="code"></span>
                            <button id="copy-game-id-btn" class="btn-icon-only" title="Copy">
                                <span class="copy-icon">&#128203;</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="lobby-content">
                    <!-- Players Panel -->
                    <div class="lobby-panel players-panel">
                        <div class="panel-header">
                            <h3><span data-i18n="lobby.players">Players</span> <span class="player-count">(<span id="player-count">0</span>/4)</span></h3>
                        </div>
                        <ul id="lobby-players" class="players-list"></ul>
                    </div>

                    <!-- Config Panel (Host Only) -->
                    <div id="config-panel" class="lobby-panel config-panel">
                        <div class="panel-header">
                            <h3 data-i18n="lobby.gameSettings">Game Settings</h3>
                        </div>

                        <div class="config-section">
                            <h4 data-i18n="lobby.addOpponents">Add Opponents</h4>
                            <div class="bot-config">
                                <div class="config-row">
                                    <label data-i18n="lobby.botType">Bot Type</label>
                                    <select id="bot-type-select" class="select-input">
                                        <option value="rl" data-i18n="lobby.botRL">AI (Neural Network)</option>
                                        <option value="rule_based" data-i18n="lobby.botRuleBased">Rule-Based</option>
                                        <option value="random" data-i18n="lobby.botRandom">Random</option>
                                    </select>
                                </div>
                                <div class="config-row">
                                    <label data-i18n="lobby.difficulty">Difficulty</label>
                                    <select id="bot-difficulty-select" class="select-input">
                                        <option value="easy" data-i18n="lobby.easy">Easy</option>
                                        <option value="medium" selected data-i18n="lobby.medium">Medium</option>
                                        <option value="hard" data-i18n="lobby.hard">Hard</option>
                                    </select>
                                </div>
                                <button id="add-bot-btn" class="btn btn-secondary">
                                    <span class="btn-icon">+</span>
                                    <span data-i18n="lobby.addBot">Add Bot</span>
                                </button>
                            </div>
                        </div>

                        <div class="config-section">
                            <h4 data-i18n="lobby.quickSetup">Quick Setup</h4>
                            <div class="quick-buttons">
                                <button id="fill-bots-btn" class="btn btn-outline btn-small" data-i18n="lobby.fillWithBots">Fill with AI Bots</button>
                                <button id="clear-bots-btn" class="btn btn-outline btn-small" data-i18n="lobby.clearBots">Remove All Bots</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="lobby-actions">
                    <button id="leave-lobby-btn" class="btn btn-ghost" data-i18n="lobby.leave">Leave</button>
                    <button id="start-game-btn" class="btn btn-primary btn-large" disabled>
                        <span data-i18n="lobby.startGame">Start Game</span>
                        <span class="btn-icon">&#9654;</span>
                    </button>
                </div>
                <p id="start-hint" class="hint" data-i18n="lobby.needPlayers">Need at least 2 players to start</p>
                <div id="lobby-error" class="error-message"></div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="game-layout">
                <!-- Top Bar -->
                <header class="game-topbar">
                    <div class="round-badge">
                        <span data-i18n="game.round">Round</span>
                        <strong><span id="current-round">1</span>/10</strong>
                    </div>
                    <div class="game-phase" id="game-status-text" data-i18n="game.waiting">Waiting...</div>
                    <div class="score-display">
                        <span data-i18n="game.yourScore">Your Score:</span>
                        <strong id="player-score">0</strong>
                    </div>
                </header>

                <!-- Main Game Area -->
                <main class="game-main">
                    <!-- Opponents Area (Top) -->
                    <div class="opponents-area" id="opponents-container"></div>

                    <!-- Center Play Area -->
                    <div class="play-area">
                        <div class="table-felt">
                            <h3 class="area-label" data-i18n="game.currentTrick">Current Trick</h3>
                            <div id="trick-cards" class="trick-cards"></div>
                            <div id="trick-winner" class="trick-winner hidden"></div>
                        </div>
                    </div>

                    <!-- Player Hand Area (Bottom) -->
                    <div class="player-area">
                        <div class="player-info-bar">
                            <div class="player-stat-item">
                                <span class="stat-label" data-i18n="game.yourBid">Your Bid:</span>
                                <span class="stat-value" id="player-bid">-</span>
                            </div>
                            <div class="player-stat-item">
                                <span class="stat-label" data-i18n="game.tricksWon">Tricks Won:</span>
                                <span class="stat-value" id="player-tricks">0</span>
                            </div>
                            <div class="player-stat-item your-turn-indicator hidden" id="your-turn-indicator">
                                <span data-i18n="game.yourTurn">Your Turn!</span>
                            </div>
                        </div>
                        <div class="hand-section">
                            <div class="hand-label">
                                <span data-i18n="game.yourHand">Your Hand</span>
                                <span class="card-count">(<span id="hand-count">0</span>)</span>
                            </div>
                            <div id="player-hand" class="hand-cards"></div>
                        </div>
                    </div>
                </main>

                <!-- Bidding Modal -->
                <div id="bidding-modal" class="modal hidden">
                    <div class="modal-content bidding-content">
                        <h3 data-i18n="game.makeYourBid">Make Your Bid</h3>
                        <p data-i18n="game.bidQuestion">How many tricks will you win?</p>
                        <div id="bid-buttons" class="bid-buttons"></div>
                    </div>
                </div>

                <!-- Tigress Choice Modal -->
                <div id="tigress-modal" class="modal hidden">
                    <div class="modal-content tigress-content">
                        <h3 data-i18n="game.tigressChoice">Scary Mary</h3>
                        <p data-i18n="game.tigressQuestion">Play as Pirate or Escape?</p>
                        <div class="tigress-card-preview">üè¥‚Äç‚ò†Ô∏èüëª</div>
                        <div class="tigress-buttons">
                            <button id="tigress-pirate" class="tigress-btn pirate-btn">
                                <span class="tigress-icon">üè¥‚Äç‚ò†Ô∏è</span>
                                <span data-i18n="game.tigressPirate">Pirate</span>
                                <small data-i18n="game.tigressPirateDesc">Win tricks, beats suits</small>
                            </button>
                            <button id="tigress-escape" class="tigress-btn escape-btn">
                                <span class="tigress-icon">üëª</span>
                                <span data-i18n="game.tigressEscape">Escape</span>
                                <small data-i18n="game.tigressEscapeDesc">Lose on purpose</small>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Game Log (collapsible) -->
                <aside class="game-log collapsed" id="game-log">
                    <button class="log-toggle" id="log-toggle">
                        <span data-i18n="game.gameLog">Game Log</span>
                        <span class="toggle-icon">&#9650;</span>
                    </button>
                    <div class="log-content" id="log-messages"></div>
                </aside>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <div class="results-container">
                <div class="results-header">
                    <div class="trophy">&#127942;</div>
                    <h2 data-i18n="results.title">Game Over!</h2>
                    <div id="winner-announcement" class="winner-announcement"></div>
                </div>
                <div class="podium">
                    <div class="podium-place second" id="place-2"></div>
                    <div class="podium-place first" id="place-1"></div>
                    <div class="podium-place third" id="place-3"></div>
                </div>
                <table id="final-scores-table" class="scores-table">
                    <thead>
                        <tr>
                            <th data-i18n="results.rank">#</th>
                            <th data-i18n="results.player">Player</th>
                            <th data-i18n="results.score">Score</th>
                        </tr>
                    </thead>
                    <tbody id="final-scores-body"></tbody>
                </table>
                <div class="results-actions">
                    <button id="new-game-btn" class="btn btn-primary btn-large">
                        <span class="btn-icon">üè¥‚Äç‚ò†Ô∏è</span>
                        <span data-i18n="results.playAgain">Play Again</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/i18n.js"></script>
    <script src="/static/js/game.js"></script>
</body>
</html>
